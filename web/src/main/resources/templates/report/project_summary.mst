<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1280" />
    <title>项目总结</title>
    <link rel="stylesheet" type="text/css" href="/public/lib/semantic.min.css">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script type="text/javascript" src="/public/lib/semantic.min.js"></script>

    <style type="text/css" media="screen">
.charts {
  height: 400px;
  width: 100%;
}
.body {
  width: 1280px;
}
.one-line {
  display: inline-block;
  width: 30%;
}
    </style>
  </head>
  <body>
    <div class="ui pointing menu stackable">
      <div class="ui container">
        <a class="active item">项目概况</a>
        <a class="item" href="/report/project">项目明细</a>
      </div>
    </div>

    <div class="ui segment container">
      <div class="ui grid">
        <div class="row">
          <div class="column">
            <div class="charts" id="project-summary"></div>
          </div>
        </div>

        <div class="row">
          <div class="column">
            <div class="charts" id="member-consumed-summary"></div>
          </div>
        </div>

        <div class="row">
          <div class="column">
            <div class="charts" id="project-timerange-summary"></div>
          </div>
        </div>
      </div>
    </div>


    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="/public/scripts/common-charts.js"></script>
    <script src="/public/scripts/projectDetail.js"></script>

    <script charset="utf-8">
      var seriesTooltip = {
          pointFormat: '{series.name}: <b>{point.y}</b>'
      };
      var yAxis = [{
            title: {
                text: '耗时'
            }
        }, {
            opposite: true,
            title: {
                text: '个数'
            }
      }];
      var projectSummary = [];

      {{#projectStats}}
        projectSummary['{{name}}'] = []
        projectSummary['{{name}}'] = projectSummary['{{name}}'].concat({
          seriesName: '需求数',
          value:
          {{#totalStories}}{{totalStories}}{{/totalStories}}{{^totalStories}}0{{/totalStories}},
          yAxis: 1
        },
        {
          seriesName: 'BUG数',
          value: {{#totalBugs}}{{totalBugs}}{{/totalBugs}}{{^totalBugs}}0{{/totalBugs}},
          yAxis: 1
        },
        {
          seriesName: '成员数',
          value:
          {{#totalMembers}}{{totalMembers}}{{/totalMembers}}{{^totalMembers}}0{{/totalMembers}},
          yAxis: 1
        },
        {
          seriesName: '耗时',
          value:
          {{#totalTimeUsage}}{{totalTimeUsage}}{{/totalTimeUsage}}{{^totalTimeUsage}}0{{/totalTimeUsage}}
        });

      {{/projectStats}}

      renderColumnBar('project-summary', '项目总体情况', yAxis, projectSummary, seriesTooltip);

      // pie for member summary
      var pieHrsTooltip = percentageToolTip('hrs');
      var memberConsumedSummary = [];
      var memberConsumedSummary = [];
      {{#memberConsumedStats}}
        memberConsumedSummary.push({name: '{{name}}', value: {{tolConsumedTime}} })
      {{/memberConsumedStats}}
      renderPie(
        'member-consumed-summary', '人员用时情况',
        memberConsumedSummary, pieHrsTooltip
      );

      // column for project stat timerange
      var projectTimerangeSummary= [];
      var yAxis4Timerange = [{
            title: {
                text: '项目数'
            }
      }];
      {{#timerangeProjectStats}}
        projectTimerangeSummary['{{timerange}}'] = []
        projectTimerangeSummary['{{timerange}}'] = projectTimerangeSummary['{{timerange}}'].concat(
        {
          seriesName: '项目数',
          value:{{totalProjects}}
        });

      {{/timerangeProjectStats}}
      renderColumnBar('project-timerange-summary', '项目周期统计', yAxis4Timerange, projectTimerangeSummary, seriesTooltip);
    </script>
  </body>
</html>
